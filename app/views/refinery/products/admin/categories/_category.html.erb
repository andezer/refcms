<li class='clearfix record  <%= cycle("on", "on-hover") %>' id="<%= dom_id(category) -%>">
  <div class='clearfix'>
    <% if category.children.present? %>
      <span class="icon toggle expanded" title="<%= t('.expand_collapse') %>"></span>
    <% else %>
      <span class="icon"></span>
    <% end %>

    <span class='title'>
      <%= category.title.presence || category.translations.detect {|t| t.title.present?}.title %>
      <span class="preview">
        <% category.translations.reject {|t| t.title.blank? }.each do |translation| %>
          <%= link_to refinery.edit_products_admin_category_path(category.nested_url, :switch_locale => translation.locale),
                      :class => 'locale' do %>
            <div class="locale_icon <%= translation.locale %>">
              <%= refinery_icon_tag('locale-blue.svg', :size => '24x24') %>
              <span class="code"><%= translation.locale.upcase %></span>
            </div>
          <% end %>
        <% end %>
      </span>
    </span>

    <span class='actions'>
      <%= link_to refinery_icon_tag('page_add.png'),
                  refinery.new_products_admin_category_path(:parent_id => category.id),
                  :title => t('.new') %>

      <%= link_to refinery_icon_tag('application_edit.png'),
                  refinery.products_admin_edit_category_path(category.nested_url, :switch_locale => (category.translations.first.locale unless category.translated_to_default_locale?)),
                  :title => t('.edit') %>

      <%= link_to refinery_icon_tag('delete.png'),
                  refinery.products_admin_delete_category_path(category.nested_url),
                  :class => "cancel confirm-delete",
                  :title => t('delete', :scope => 'refinery.admin.pages'),
                  :data => {
                    :confirm => t('message',
                      :scope => 'refinery.admin.delete',
                      :title => category.title.presence || category.translations.detect {|t| t.title.present?}.title
                    )
                  },
                  :method => :delete %>
    </span>
  </div>
  <ul class='nested' data-ajax-content="<%= refinery.products_admin_children_categories_path(category.nested_url) %>">
    <%= render(:partial => 'category', :collection => category.children) %>
  </ul>
</li>
